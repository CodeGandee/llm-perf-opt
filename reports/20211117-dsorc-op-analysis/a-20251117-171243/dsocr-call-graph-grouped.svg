<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 13.1.2 (20250809.0930)
 -->
<!-- Title: dsocr_grouped Pages: 1 -->
<svg width="1064pt" height="4836pt"
 viewBox="0.00 0.00 1064.00 4836.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4832)">
<title>dsocr_grouped</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-4832 1060.06,-4832 1060.06,4 -4,4"/>
<!-- Block @ sam_model.blocks[0..11] -->
<g id="node1" class="node">
<title>Block @ sam_model.blocks[0..11]</title>
<polygon fill="none" stroke="black" points="941.68,-362 687.93,-362 687.93,-285 941.68,-285 941.68,-362"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-344.7" font-family="Times,serif" font-size="14.00">Block @ sam_model.blocks[0..11]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-327.45" font-family="Times,serif" font-size="14.00">for 12</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-310.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-292.95" font-family="Times,serif" font-size="14.00">parent=sam_model</text>
</g>
<!-- Conv2d @ sam_model.neck[0..3] -->
<g id="node2" class="node">
<title>Conv2d @ sam_model.neck[0..3]</title>
<polygon fill="none" stroke="black" points="938.68,-457 690.93,-457 690.93,-380 938.68,-380 938.68,-457"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-439.7" font-family="Times,serif" font-size="14.00">Conv2d @ sam_model.neck[0..3]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-422.45" font-family="Times,serif" font-size="14.00">for 4</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-405.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-387.95" font-family="Times,serif" font-size="14.00">parent=sam_model.neck</text>
</g>
<!-- NoTPTransformerBlock @ vision_model.transformer.layers[0..23] -->
<g id="node3" class="node">
<title>NoTPTransformerBlock @ vision_model.transformer.layers[0..23]</title>
<polygon fill="none" stroke="black" points="1056.06,-552 573.56,-552 573.56,-475 1056.06,-475 1056.06,-552"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-534.7" font-family="Times,serif" font-size="14.00">NoTPTransformerBlock @ vision_model.transformer.layers[0..23]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-517.45" font-family="Times,serif" font-size="14.00">for 24</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-500.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-482.95" font-family="Times,serif" font-size="14.00">parent=vision_model.transformer</text>
</g>
<!-- DeepseekV2DecoderLayer @ layers[0..11] -->
<g id="node4" class="node">
<title>DeepseekV2DecoderLayer @ layers[0..11]</title>
<polygon fill="none" stroke="black" points="384.78,-591.75 68.03,-591.75 68.03,-549.25 384.78,-549.25 384.78,-591.75"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-574.45" font-family="Times,serif" font-size="14.00">DeepseekV2DecoderLayer @ layers[0..11]</text>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-557.2" font-family="Times,serif" font-size="14.00">for 12</text>
</g>
<!-- DeepseekV2MLP @ layers.1.mlp.experts[0..63] -->
<g id="node5" class="node">
<title>DeepseekV2MLP @ layers.1.mlp.experts[0..63]</title>
<polygon fill="none" stroke="black" points="991.56,-666 638.06,-666 638.06,-589 991.56,-589 991.56,-666"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-648.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.1.mlp.experts[0..63]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-631.45" font-family="Times,serif" font-size="14.00">for 64</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-614.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-596.95" font-family="Times,serif" font-size="14.00">parent=layers.1.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.2.mlp.experts[0..18] -->
<g id="node6" class="node">
<title>DeepseekV2MLP @ layers.2.mlp.experts[0..18]</title>
<polygon fill="none" stroke="black" points="991.56,-951 638.06,-951 638.06,-874 991.56,-874 991.56,-951"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-933.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.2.mlp.experts[0..18]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-916.45" font-family="Times,serif" font-size="14.00">for 19</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-899.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-881.95" font-family="Times,serif" font-size="14.00">parent=layers.2.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.2.mlp.experts[20..57] -->
<g id="node7" class="node">
<title>DeepseekV2MLP @ layers.2.mlp.experts[20..57]</title>
<polygon fill="none" stroke="black" points="996.06,-856 633.56,-856 633.56,-779 996.06,-779 996.06,-856"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-838.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.2.mlp.experts[20..57]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-821.45" font-family="Times,serif" font-size="14.00">for 38</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-804.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-786.95" font-family="Times,serif" font-size="14.00">parent=layers.2.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.2.mlp.experts[59..63] -->
<g id="node8" class="node">
<title>DeepseekV2MLP @ layers.2.mlp.experts[59..63]</title>
<polygon fill="none" stroke="black" points="996.06,-761 633.56,-761 633.56,-684 996.06,-684 996.06,-761"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-743.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.2.mlp.experts[59..63]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-726.45" font-family="Times,serif" font-size="14.00">for 5</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-709.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-691.95" font-family="Times,serif" font-size="14.00">parent=layers.2.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.3.mlp.experts[0..52] -->
<g id="node9" class="node">
<title>DeepseekV2MLP @ layers.3.mlp.experts[0..52]</title>
<polygon fill="none" stroke="black" points="991.56,-1141 638.06,-1141 638.06,-1064 991.56,-1064 991.56,-1141"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1123.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.3.mlp.experts[0..52]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1106.45" font-family="Times,serif" font-size="14.00">for 53</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1089.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1071.95" font-family="Times,serif" font-size="14.00">parent=layers.3.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.3.mlp.experts[54..63] -->
<g id="node10" class="node">
<title>DeepseekV2MLP @ layers.3.mlp.experts[54..63]</title>
<polygon fill="none" stroke="black" points="996.06,-1046 633.56,-1046 633.56,-969 996.06,-969 996.06,-1046"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1028.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.3.mlp.experts[54..63]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1011.45" font-family="Times,serif" font-size="14.00">for 10</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-994.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-976.95" font-family="Times,serif" font-size="14.00">parent=layers.3.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.4.mlp.experts[0..63] -->
<g id="node11" class="node">
<title>DeepseekV2MLP @ layers.4.mlp.experts[0..63]</title>
<polygon fill="none" stroke="black" points="991.56,-1236 638.06,-1236 638.06,-1159 991.56,-1159 991.56,-1236"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1218.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.4.mlp.experts[0..63]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1201.45" font-family="Times,serif" font-size="14.00">for 64</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1184.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1166.95" font-family="Times,serif" font-size="14.00">parent=layers.4.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.5.mlp.experts[0..63] -->
<g id="node12" class="node">
<title>DeepseekV2MLP @ layers.5.mlp.experts[0..63]</title>
<polygon fill="none" stroke="black" points="991.56,-1331 638.06,-1331 638.06,-1254 991.56,-1254 991.56,-1331"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1313.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.5.mlp.experts[0..63]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1296.45" font-family="Times,serif" font-size="14.00">for 64</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1279.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1261.95" font-family="Times,serif" font-size="14.00">parent=layers.5.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.6.mlp.experts[0..63] -->
<g id="node13" class="node">
<title>DeepseekV2MLP @ layers.6.mlp.experts[0..63]</title>
<polygon fill="none" stroke="black" points="991.56,-1426 638.06,-1426 638.06,-1349 991.56,-1349 991.56,-1426"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1408.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.6.mlp.experts[0..63]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1391.45" font-family="Times,serif" font-size="14.00">for 64</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1374.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1356.95" font-family="Times,serif" font-size="14.00">parent=layers.6.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.7.mlp.experts[0..63] -->
<g id="node14" class="node">
<title>DeepseekV2MLP @ layers.7.mlp.experts[0..63]</title>
<polygon fill="none" stroke="black" points="991.56,-1521 638.06,-1521 638.06,-1444 991.56,-1444 991.56,-1521"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1503.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.7.mlp.experts[0..63]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1486.45" font-family="Times,serif" font-size="14.00">for 64</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1469.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1451.95" font-family="Times,serif" font-size="14.00">parent=layers.7.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.8.mlp.experts[0..5] -->
<g id="node15" class="node">
<title>DeepseekV2MLP @ layers.8.mlp.experts[0..5]</title>
<polygon fill="none" stroke="black" points="987.06,-1711 642.56,-1711 642.56,-1634 987.06,-1634 987.06,-1711"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1693.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.8.mlp.experts[0..5]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1676.45" font-family="Times,serif" font-size="14.00">for 6</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1659.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1641.95" font-family="Times,serif" font-size="14.00">parent=layers.8.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.8.mlp.experts[7..63] -->
<g id="node16" class="node">
<title>DeepseekV2MLP @ layers.8.mlp.experts[7..63]</title>
<polygon fill="none" stroke="black" points="991.56,-1616 638.06,-1616 638.06,-1539 991.56,-1539 991.56,-1616"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1598.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.8.mlp.experts[7..63]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1581.45" font-family="Times,serif" font-size="14.00">for 57</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1564.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1546.95" font-family="Times,serif" font-size="14.00">parent=layers.8.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.9.mlp.experts[0..63] -->
<g id="node17" class="node">
<title>DeepseekV2MLP @ layers.9.mlp.experts[0..63]</title>
<polygon fill="none" stroke="black" points="991.56,-1806 638.06,-1806 638.06,-1729 991.56,-1729 991.56,-1806"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1788.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.9.mlp.experts[0..63]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1771.45" font-family="Times,serif" font-size="14.00">for 64</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1754.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1736.95" font-family="Times,serif" font-size="14.00">parent=layers.9.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.10.mlp.experts[0..63] -->
<g id="node18" class="node">
<title>DeepseekV2MLP @ layers.10.mlp.experts[0..63]</title>
<polygon fill="none" stroke="black" points="996.06,-1901 633.56,-1901 633.56,-1824 996.06,-1824 996.06,-1901"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1883.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.10.mlp.experts[0..63]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1866.45" font-family="Times,serif" font-size="14.00">for 64</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1849.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1831.95" font-family="Times,serif" font-size="14.00">parent=layers.10.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.11.mlp.experts[0..63] -->
<g id="node19" class="node">
<title>DeepseekV2MLP @ layers.11.mlp.experts[0..63]</title>
<polygon fill="none" stroke="black" points="996.06,-1996 633.56,-1996 633.56,-1919 996.06,-1919 996.06,-1996"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1978.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.11.mlp.experts[0..63]</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1961.45" font-family="Times,serif" font-size="14.00">for 64</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1944.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-1926.95" font-family="Times,serif" font-size="14.00">parent=layers.11.mlp</text>
</g>
<!-- PatchEmbed @ sam_model.patch_embed -->
<g id="node20" class="node">
<title>PatchEmbed @ sam_model.patch_embed</title>
<polygon fill="none" stroke="black" points="968.68,-267 660.93,-267 660.93,-190 968.68,-190 968.68,-267"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-249.7" font-family="Times,serif" font-size="14.00">PatchEmbed @ sam_model.patch_embed</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-232.45" font-family="Times,serif" font-size="14.00">parfor 4</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-215.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-197.95" font-family="Times,serif" font-size="14.00">parent=sam_model</text>
</g>
<!-- Conv2d @ sam_model.patch_embed.proj -->
<g id="node21" class="node">
<title>Conv2d @ sam_model.patch_embed.proj</title>
<polygon fill="none" stroke="black" points="967.18,-2091 662.43,-2091 662.43,-2014 967.18,-2014 967.18,-2091"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2073.7" font-family="Times,serif" font-size="14.00">Conv2d @ sam_model.patch_embed.proj</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2056.45" font-family="Times,serif" font-size="14.00">parfor 2</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2039.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2021.95" font-family="Times,serif" font-size="14.00">parent=sam_model.patch_embed</text>
</g>
<!-- LayerNorm @ sam_model.blocks.*.norm1 -->
<g id="node22" class="node">
<title>LayerNorm @ sam_model.blocks.*.norm1</title>
<polygon fill="none" stroke="black" points="970.56,-2471 659.06,-2471 659.06,-2394 970.56,-2394 970.56,-2471"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2453.7" font-family="Times,serif" font-size="14.00">LayerNorm @ sam_model.blocks.*.norm1</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2436.45" font-family="Times,serif" font-size="14.00">parfor 24</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2419.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2401.95" font-family="Times,serif" font-size="14.00">parent=sam_model.blocks.*</text>
</g>
<!-- Attention @ sam_model.blocks.*.attn -->
<g id="node23" class="node">
<title>Attention @ sam_model.blocks.*.attn</title>
<polygon fill="none" stroke="black" points="954.81,-2376 674.81,-2376 674.81,-2299 954.81,-2299 954.81,-2376"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2358.7" font-family="Times,serif" font-size="14.00">Attention @ sam_model.blocks.*.attn</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2341.45" font-family="Times,serif" font-size="14.00">parfor 1160</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2324.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2306.95" font-family="Times,serif" font-size="14.00">parent=sam_model.blocks.*</text>
</g>
<!-- Linear @ sam_model.blocks.*.attn.qkv -->
<g id="node24" class="node">
<title>Linear @ sam_model.blocks.*.attn.qkv</title>
<polygon fill="none" stroke="black" points="959.31,-2661 670.31,-2661 670.31,-2584 959.31,-2584 959.31,-2661"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2643.7" font-family="Times,serif" font-size="14.00">Linear @ sam_model.blocks.*.attn.qkv</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2626.45" font-family="Times,serif" font-size="14.00">parfor 24</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2609.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2591.95" font-family="Times,serif" font-size="14.00">parent=sam_model.blocks.*.attn</text>
</g>
<!-- Linear @ sam_model.blocks.*.attn.proj -->
<g id="node25" class="node">
<title>Linear @ sam_model.blocks.*.attn.proj</title>
<polygon fill="none" stroke="black" points="960.81,-2566 668.81,-2566 668.81,-2489 960.81,-2489 960.81,-2566"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2548.7" font-family="Times,serif" font-size="14.00">Linear @ sam_model.blocks.*.attn.proj</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2531.45" font-family="Times,serif" font-size="14.00">parfor 24</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2514.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2496.95" font-family="Times,serif" font-size="14.00">parent=sam_model.blocks.*.attn</text>
</g>
<!-- LayerNorm @ sam_model.blocks.*.norm2 -->
<g id="node26" class="node">
<title>LayerNorm @ sam_model.blocks.*.norm2</title>
<polygon fill="none" stroke="black" points="970.56,-2281 659.06,-2281 659.06,-2204 970.56,-2204 970.56,-2281"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2263.7" font-family="Times,serif" font-size="14.00">LayerNorm @ sam_model.blocks.*.norm2</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2246.45" font-family="Times,serif" font-size="14.00">parfor 24</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2229.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2211.95" font-family="Times,serif" font-size="14.00">parent=sam_model.blocks.*</text>
</g>
<!-- MLPBlock @ sam_model.blocks.*.mlp -->
<g id="node27" class="node">
<title>MLPBlock @ sam_model.blocks.*.mlp</title>
<polygon fill="none" stroke="black" points="956.31,-2186 673.31,-2186 673.31,-2109 956.31,-2109 956.31,-2186"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2168.7" font-family="Times,serif" font-size="14.00">MLPBlock @ sam_model.blocks.*.mlp</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2151.45" font-family="Times,serif" font-size="14.00">parfor 72</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2134.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2116.95" font-family="Times,serif" font-size="14.00">parent=sam_model.blocks.*</text>
</g>
<!-- Linear @ sam_model.blocks.*.mlp.lin1 -->
<g id="node28" class="node">
<title>Linear @ sam_model.blocks.*.mlp.lin1</title>
<polygon fill="none" stroke="black" points="958.93,-2946 670.68,-2946 670.68,-2869 958.93,-2869 958.93,-2946"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2928.7" font-family="Times,serif" font-size="14.00">Linear @ sam_model.blocks.*.mlp.lin1</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2911.45" font-family="Times,serif" font-size="14.00">parfor 24</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2894.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2876.95" font-family="Times,serif" font-size="14.00">parent=sam_model.blocks.*.mlp</text>
</g>
<!-- GELU @ sam_model.blocks.*.mlp.act -->
<g id="node29" class="node">
<title>GELU @ sam_model.blocks.*.mlp.act</title>
<polygon fill="none" stroke="black" points="954.43,-2851 675.18,-2851 675.18,-2774 954.43,-2774 954.43,-2851"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2833.7" font-family="Times,serif" font-size="14.00">GELU @ sam_model.blocks.*.mlp.act</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2816.45" font-family="Times,serif" font-size="14.00">parfor 24</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2799.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2781.95" font-family="Times,serif" font-size="14.00">parent=sam_model.blocks.*.mlp</text>
</g>
<!-- Linear @ sam_model.blocks.*.mlp.lin2 -->
<g id="node30" class="node">
<title>Linear @ sam_model.blocks.*.mlp.lin2</title>
<polygon fill="none" stroke="black" points="958.93,-2756 670.68,-2756 670.68,-2679 958.93,-2679 958.93,-2756"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2738.7" font-family="Times,serif" font-size="14.00">Linear @ sam_model.blocks.*.mlp.lin2</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2721.45" font-family="Times,serif" font-size="14.00">parfor 24</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2704.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2686.95" font-family="Times,serif" font-size="14.00">parent=sam_model.blocks.*.mlp</text>
</g>
<!-- Conv2d @ sam_model.net_2 -->
<g id="node31" class="node">
<title>Conv2d @ sam_model.net_2</title>
<polygon fill="none" stroke="black" points="922.93,-172 706.68,-172 706.68,-95 922.93,-95 922.93,-172"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-154.7" font-family="Times,serif" font-size="14.00">Conv2d @ sam_model.net_2</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-137.45" font-family="Times,serif" font-size="14.00">parfor 2</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-120.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-102.95" font-family="Times,serif" font-size="14.00">parent=sam_model</text>
</g>
<!-- Conv2d @ sam_model.net_3 -->
<g id="node32" class="node">
<title>Conv2d @ sam_model.net_3</title>
<polygon fill="none" stroke="black" points="922.93,-77 706.68,-77 706.68,0 922.93,0 922.93,-77"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-59.7" font-family="Times,serif" font-size="14.00">Conv2d @ sam_model.net_3</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-42.45" font-family="Times,serif" font-size="14.00">parfor 2</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-25.2" font-family="Times,serif" font-size="14.00">stage=sam</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-7.95" font-family="Times,serif" font-size="14.00">parent=sam_model</text>
</g>
<!-- CLIPVisionEmbeddings @ vision_model.embeddings -->
<g id="node33" class="node">
<title>CLIPVisionEmbeddings @ vision_model.embeddings</title>
<polygon fill="none" stroke="black" points="1009.93,-3231 619.68,-3231 619.68,-3154 1009.93,-3154 1009.93,-3231"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3213.7" font-family="Times,serif" font-size="14.00">CLIPVisionEmbeddings @ vision_model.embeddings</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3196.45" font-family="Times,serif" font-size="14.00">parfor 30</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3179.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3161.95" font-family="Times,serif" font-size="14.00">parent=vision_model</text>
</g>
<!-- Embedding @ vision_model.embeddings.position_embedding -->
<g id="node34" class="node">
<title>Embedding @ vision_model.embeddings.position_embedding</title>
<polygon fill="none" stroke="black" points="1041.06,-3326 588.56,-3326 588.56,-3249 1041.06,-3249 1041.06,-3326"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3308.7" font-family="Times,serif" font-size="14.00">Embedding @ vision_model.embeddings.position_embedding</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3291.45" font-family="Times,serif" font-size="14.00">parfor 4</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3274.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3256.95" font-family="Times,serif" font-size="14.00">parent=vision_model.embeddings</text>
</g>
<!-- LayerNorm @ vision_model.pre_layrnorm -->
<g id="node35" class="node">
<title>LayerNorm @ vision_model.pre_layrnorm</title>
<polygon fill="none" stroke="black" points="971.31,-3136 658.31,-3136 658.31,-3059 971.31,-3059 971.31,-3136"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3118.7" font-family="Times,serif" font-size="14.00">LayerNorm @ vision_model.pre_layrnorm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3101.45" font-family="Times,serif" font-size="14.00">parfor 2</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3084.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3066.95" font-family="Times,serif" font-size="14.00">parent=vision_model</text>
</g>
<!-- NoTPTransformer @ vision_model.transformer -->
<g id="node36" class="node">
<title>NoTPTransformer @ vision_model.transformer</title>
<polygon fill="none" stroke="black" points="990.06,-3041 639.56,-3041 639.56,-2964 990.06,-2964 990.06,-3041"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3023.7" font-family="Times,serif" font-size="14.00">NoTPTransformer @ vision_model.transformer</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3006.45" font-family="Times,serif" font-size="14.00">parfor 1152</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2989.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-2971.95" font-family="Times,serif" font-size="14.00">parent=vision_model</text>
</g>
<!-- LayerNorm @ vision_model.transformer.layers.*.layer_norm1 -->
<g id="node37" class="node">
<title>LayerNorm @ vision_model.transformer.layers.*.layer_norm1</title>
<polygon fill="none" stroke="black" points="1042.18,-3706 587.43,-3706 587.43,-3629 1042.18,-3629 1042.18,-3706"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3688.7" font-family="Times,serif" font-size="14.00">LayerNorm @ vision_model.transformer.layers.*.layer_norm1</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3671.45" font-family="Times,serif" font-size="14.00">parfor 48</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3654.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3636.95" font-family="Times,serif" font-size="14.00">parent=vision_model.transformer.layers.*</text>
</g>
<!-- NoTPAttention @ vision_model.transformer.layers.*.self_attn -->
<g id="node38" class="node">
<title>NoTPAttention @ vision_model.transformer.layers.*.self_attn</title>
<polygon fill="none" stroke="black" points="1039.93,-3611 589.68,-3611 589.68,-3534 1039.93,-3534 1039.93,-3611"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3593.7" font-family="Times,serif" font-size="14.00">NoTPAttention @ vision_model.transformer.layers.*.self_attn</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3576.45" font-family="Times,serif" font-size="14.00">parfor 720</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3559.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3541.95" font-family="Times,serif" font-size="14.00">parent=vision_model.transformer.layers.*</text>
</g>
<!-- Linear @ vision_model.transformer.layers.*.self_attn.qkv_proj -->
<g id="node39" class="node">
<title>Linear @ vision_model.transformer.layers.*.self_attn.qkv_proj</title>
<polygon fill="none" stroke="black" points="1043.31,-3896 586.31,-3896 586.31,-3819 1043.31,-3819 1043.31,-3896"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3878.7" font-family="Times,serif" font-size="14.00">Linear @ vision_model.transformer.layers.*.self_attn.qkv_proj</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3861.45" font-family="Times,serif" font-size="14.00">parfor 48</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3844.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3826.95" font-family="Times,serif" font-size="14.00">parent=vision_model.transformer.layers.*.self_attn</text>
</g>
<!-- Linear @ vision_model.transformer.layers.*.self_attn.out_proj -->
<g id="node40" class="node">
<title>Linear @ vision_model.transformer.layers.*.self_attn.out_proj</title>
<polygon fill="none" stroke="black" points="1042.18,-3801 587.43,-3801 587.43,-3724 1042.18,-3724 1042.18,-3801"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3783.7" font-family="Times,serif" font-size="14.00">Linear @ vision_model.transformer.layers.*.self_attn.out_proj</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3766.45" font-family="Times,serif" font-size="14.00">parfor 48</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3749.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3731.95" font-family="Times,serif" font-size="14.00">parent=vision_model.transformer.layers.*.self_attn</text>
</g>
<!-- LayerNorm @ vision_model.transformer.layers.*.layer_norm2 -->
<g id="node41" class="node">
<title>LayerNorm @ vision_model.transformer.layers.*.layer_norm2</title>
<polygon fill="none" stroke="black" points="1042.18,-3516 587.43,-3516 587.43,-3439 1042.18,-3439 1042.18,-3516"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3498.7" font-family="Times,serif" font-size="14.00">LayerNorm @ vision_model.transformer.layers.*.layer_norm2</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3481.45" font-family="Times,serif" font-size="14.00">parfor 48</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3464.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3446.95" font-family="Times,serif" font-size="14.00">parent=vision_model.transformer.layers.*</text>
</g>
<!-- NoTPFeedForward @ vision_model.transformer.layers.*.mlp -->
<g id="node42" class="node">
<title>NoTPFeedForward @ vision_model.transformer.layers.*.mlp</title>
<polygon fill="none" stroke="black" points="1037.31,-3421 592.31,-3421 592.31,-3344 1037.31,-3344 1037.31,-3421"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3403.7" font-family="Times,serif" font-size="14.00">NoTPFeedForward @ vision_model.transformer.layers.*.mlp</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3386.45" font-family="Times,serif" font-size="14.00">parfor 240</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3369.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3351.95" font-family="Times,serif" font-size="14.00">parent=vision_model.transformer.layers.*</text>
</g>
<!-- Linear @ vision_model.transformer.layers.*.mlp.fc1 -->
<g id="node43" class="node">
<title>Linear @ vision_model.transformer.layers.*.mlp.fc1</title>
<polygon fill="none" stroke="black" points="1006.56,-4086 623.06,-4086 623.06,-4009 1006.56,-4009 1006.56,-4086"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4068.7" font-family="Times,serif" font-size="14.00">Linear @ vision_model.transformer.layers.*.mlp.fc1</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4051.45" font-family="Times,serif" font-size="14.00">parfor 48</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4034.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4016.95" font-family="Times,serif" font-size="14.00">parent=vision_model.transformer.layers.*.mlp</text>
</g>
<!-- Linear @ vision_model.transformer.layers.*.mlp.fc2 -->
<g id="node44" class="node">
<title>Linear @ vision_model.transformer.layers.*.mlp.fc2</title>
<polygon fill="none" stroke="black" points="1006.56,-3991 623.06,-3991 623.06,-3914 1006.56,-3914 1006.56,-3991"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3973.7" font-family="Times,serif" font-size="14.00">Linear @ vision_model.transformer.layers.*.mlp.fc2</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3956.45" font-family="Times,serif" font-size="14.00">parfor 48</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3939.2" font-family="Times,serif" font-size="14.00">stage=vision</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-3921.95" font-family="Times,serif" font-size="14.00">parent=vision_model.transformer.layers.*.mlp</text>
</g>
<!-- Linear @ projector.layers -->
<g id="node45" class="node">
<title>Linear @ projector.layers</title>
<polygon fill="none" stroke="black" points="913.18,-4163.38 716.43,-4163.38 716.43,-4103.62 913.18,-4103.62 913.18,-4163.38"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4146.07" font-family="Times,serif" font-size="14.00">Linear @ projector.layers</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4128.82" font-family="Times,serif" font-size="14.00">parfor 2</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4111.57" font-family="Times,serif" font-size="14.00">parent=projector</text>
</g>
<!-- DeepseekV2RMSNorm @ layers.*.input_layernorm -->
<g id="node46" class="node">
<title>DeepseekV2RMSNorm @ layers.*.input_layernorm</title>
<polygon fill="none" stroke="black" points="1004.31,-4543 625.31,-4543 625.31,-4466 1004.31,-4466 1004.31,-4543"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4525.7" font-family="Times,serif" font-size="14.00">DeepseekV2RMSNorm @ layers.*.input_layernorm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4508.45" font-family="Times,serif" font-size="14.00">parfor 96</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4491.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4473.95" font-family="Times,serif" font-size="14.00">parent=layers.*</text>
</g>
<!-- LlamaAttention @ layers.*.self_attn -->
<g id="node47" class="node">
<title>LlamaAttention @ layers.*.self_attn</title>
<polygon fill="none" stroke="black" points="949.93,-4448 679.68,-4448 679.68,-4371 949.93,-4371 949.93,-4448"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4430.7" font-family="Times,serif" font-size="14.00">LlamaAttention @ layers.*.self_attn</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4413.45" font-family="Times,serif" font-size="14.00">parfor 792</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4396.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4378.95" font-family="Times,serif" font-size="14.00">parent=layers.*</text>
</g>
<!-- LlamaRotaryEmbedding @ layers.*.self_attn.rotary_emb -->
<g id="node48" class="node">
<title>LlamaRotaryEmbedding @ layers.*.self_attn.rotary_emb</title>
<polygon fill="none" stroke="black" points="1024.56,-4638 605.06,-4638 605.06,-4561 1024.56,-4561 1024.56,-4638"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4620.7" font-family="Times,serif" font-size="14.00">LlamaRotaryEmbedding @ layers.*.self_attn.rotary_emb</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4603.45" font-family="Times,serif" font-size="14.00">parfor 204</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4586.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4568.95" font-family="Times,serif" font-size="14.00">parent=layers.*.self_attn</text>
</g>
<!-- DeepseekV2RMSNorm @ layers.*.post_attention_layernorm -->
<g id="node49" class="node">
<title>DeepseekV2RMSNorm @ layers.*.post_attention_layernorm</title>
<polygon fill="none" stroke="black" points="1036.93,-4353 592.68,-4353 592.68,-4276 1036.93,-4276 1036.93,-4353"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4335.7" font-family="Times,serif" font-size="14.00">DeepseekV2RMSNorm @ layers.*.post_attention_layernorm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4318.45" font-family="Times,serif" font-size="14.00">parfor 96</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4301.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4283.95" font-family="Times,serif" font-size="14.00">parent=layers.*</text>
</g>
<!-- DeepseekV2MLP @ layers.*.mlp -->
<g id="node50" class="node">
<title>DeepseekV2MLP @ layers.*.mlp</title>
<polygon fill="none" stroke="black" points="937.93,-4258 691.68,-4258 691.68,-4181 937.93,-4181 937.93,-4258"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4240.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.*.mlp</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4223.45" font-family="Times,serif" font-size="14.00">parfor 4579</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4206.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4188.95" font-family="Times,serif" font-size="14.00">parent=layers.*</text>
</g>
<!-- MoEGate @ layers.*.mlp.gate -->
<g id="node51" class="node">
<title>MoEGate @ layers.*.mlp.gate</title>
<polygon fill="none" stroke="black" points="928.93,-4828 700.68,-4828 700.68,-4751 928.93,-4751 928.93,-4828"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4810.7" font-family="Times,serif" font-size="14.00">MoEGate @ layers.*.mlp.gate</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4793.45" font-family="Times,serif" font-size="14.00">parfor 88</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4776.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4758.95" font-family="Times,serif" font-size="14.00">parent=layers.*.mlp</text>
</g>
<!-- DeepseekV2MLP @ layers.*.mlp.shared_experts -->
<g id="node52" class="node">
<title>DeepseekV2MLP @ layers.*.mlp.shared_experts</title>
<polygon fill="none" stroke="black" points="994.93,-4733 634.68,-4733 634.68,-4656 994.93,-4656 994.93,-4733"/>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4715.7" font-family="Times,serif" font-size="14.00">DeepseekV2MLP @ layers.*.mlp.shared_experts</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4698.45" font-family="Times,serif" font-size="14.00">parfor 55</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4681.2" font-family="Times,serif" font-size="14.00">stage=llm</text>
<text xml:space="preserve" text-anchor="middle" x="814.81" y="-4663.95" font-family="Times,serif" font-size="14.00">parent=layers.*.mlp</text>
</g>
<!-- sam_model -->
<g id="node53" class="node">
<title>sam_model</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-181.5" rx="66.99" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-176.82" font-family="Times,serif" font-size="14.00">sam_model</text>
</g>
<!-- sam_model&#45;&gt;Block @ sam_model.blocks[0..11] -->
<g id="edge1" class="edge">
<title>sam_model&#45;&gt;Block @ sam_model.blocks[0..11]</title>
<path fill="none" stroke="black" d="M272.79,-194.88C338.7,-214.08 464.9,-249.92 573.56,-275.5 606.81,-283.33 642.84,-290.97 676.63,-297.77"/>
<polygon fill="black" stroke="black" points="675.54,-301.12 686.04,-299.65 676.92,-294.25 675.54,-301.12"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-274.97" font-family="Times,serif" font-size="14.00">for 12</text>
</g>
<!-- sam_model&#45;&gt;PatchEmbed @ sam_model.patch_embed -->
<g id="edge19" class="edge">
<title>sam_model&#45;&gt;PatchEmbed @ sam_model.patch_embed</title>
<path fill="none" stroke="black" d="M290.99,-186.6C376.16,-193.42 530.31,-205.78 649.24,-215.31"/>
<polygon fill="black" stroke="black" points="648.88,-218.79 659.13,-216.1 649.44,-211.81 648.88,-218.79"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-210.36" font-family="Times,serif" font-size="14.00">parfor 4</text>
</g>
<!-- sam_model&#45;&gt;Conv2d @ sam_model.net_2 -->
<g id="edge30" class="edge">
<title>sam_model&#45;&gt;Conv2d @ sam_model.net_2</title>
<path fill="none" stroke="black" d="M290.99,-176.29C387.6,-168.39 572.98,-153.21 695.02,-143.22"/>
<polygon fill="black" stroke="black" points="695.07,-146.73 704.75,-142.43 694.5,-139.75 695.07,-146.73"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-164.32" font-family="Times,serif" font-size="14.00">parfor 2</text>
</g>
<!-- sam_model&#45;&gt;Conv2d @ sam_model.net_3 -->
<g id="edge31" class="edge">
<title>sam_model&#45;&gt;Conv2d @ sam_model.net_3</title>
<path fill="none" stroke="black" d="M271.93,-167.96C337.55,-148.28 464.3,-111.3 573.56,-85.5 613.07,-76.17 656.54,-67.26 695.52,-59.76"/>
<polygon fill="black" stroke="black" points="695.73,-63.28 704.9,-57.96 694.42,-56.4 695.73,-63.28"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-113.52" font-family="Times,serif" font-size="14.00">parfor 2</text>
</g>
<!-- sam_model.neck -->
<g id="node54" class="node">
<title>sam_model.neck</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-418.5" rx="93.3" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-413.82" font-family="Times,serif" font-size="14.00">sam_model.neck</text>
</g>
<!-- sam_model.neck&#45;&gt;Conv2d @ sam_model.neck[0..3] -->
<g id="edge2" class="edge">
<title>sam_model.neck&#45;&gt;Conv2d @ sam_model.neck[0..3]</title>
<path fill="none" stroke="black" d="M320,-418.5C416.63,-418.5 569.11,-418.5 679.07,-418.5"/>
<polygon fill="black" stroke="black" points="679.07,-422 689.07,-418.5 679.07,-415 679.07,-422"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-422.45" font-family="Times,serif" font-size="14.00">for 4</text>
</g>
<!-- vision_model.transformer -->
<g id="node55" class="node">
<title>vision_model.transformer</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-513.5" rx="139.59" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-508.82" font-family="Times,serif" font-size="14.00">vision_model.transformer</text>
</g>
<!-- vision_model.transformer&#45;&gt;NoTPTransformerBlock @ vision_model.transformer.layers[0..23] -->
<g id="edge3" class="edge">
<title>vision_model.transformer&#45;&gt;NoTPTransformerBlock @ vision_model.transformer.layers[0..23]</title>
<path fill="none" stroke="black" d="M366.37,-513.5C424.92,-513.5 494.94,-513.5 562.02,-513.5"/>
<polygon fill="black" stroke="black" points="561.67,-517 571.67,-513.5 561.67,-510 561.67,-517"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-517.45" font-family="Times,serif" font-size="14.00">for 24</text>
</g>
<!-- layers.1.mlp -->
<g id="node56" class="node">
<title>layers.1.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-627.5" rx="73.3" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-622.83" font-family="Times,serif" font-size="14.00">layers.1.mlp</text>
</g>
<!-- layers.1.mlp&#45;&gt;DeepseekV2MLP @ layers.1.mlp.experts[0..63] -->
<g id="edge4" class="edge">
<title>layers.1.mlp&#45;&gt;DeepseekV2MLP @ layers.1.mlp.experts[0..63]</title>
<path fill="none" stroke="black" d="M300.19,-627.5C381.22,-627.5 515.37,-627.5 626.25,-627.5"/>
<polygon fill="black" stroke="black" points="626.08,-631 636.08,-627.5 626.08,-624 626.08,-631"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-631.45" font-family="Times,serif" font-size="14.00">for 64</text>
</g>
<!-- layers.2.mlp -->
<g id="node57" class="node">
<title>layers.2.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-817.5" rx="73.3" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-812.83" font-family="Times,serif" font-size="14.00">layers.2.mlp</text>
</g>
<!-- layers.2.mlp&#45;&gt;DeepseekV2MLP @ layers.2.mlp.experts[0..18] -->
<g id="edge5" class="edge">
<title>layers.2.mlp&#45;&gt;DeepseekV2MLP @ layers.2.mlp.experts[0..18]</title>
<path fill="none" stroke="black" d="M288.5,-827.4C367.86,-840.25 510,-863.28 626.44,-882.15"/>
<polygon fill="black" stroke="black" points="625.69,-885.57 636.13,-883.72 626.81,-878.66 625.69,-885.57"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-871.8" font-family="Times,serif" font-size="14.00">for 19</text>
</g>
<!-- layers.2.mlp&#45;&gt;DeepseekV2MLP @ layers.2.mlp.experts[20..57] -->
<g id="edge6" class="edge">
<title>layers.2.mlp&#45;&gt;DeepseekV2MLP @ layers.2.mlp.experts[20..57]</title>
<path fill="none" stroke="black" d="M300.19,-817.5C380.18,-817.5 511.94,-817.5 621.98,-817.5"/>
<polygon fill="black" stroke="black" points="621.72,-821 631.72,-817.5 621.72,-814 621.72,-821"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-821.45" font-family="Times,serif" font-size="14.00">for 38</text>
</g>
<!-- layers.2.mlp&#45;&gt;DeepseekV2MLP @ layers.2.mlp.experts[59..63] -->
<g id="edge7" class="edge">
<title>layers.2.mlp&#45;&gt;DeepseekV2MLP @ layers.2.mlp.experts[59..63]</title>
<path fill="none" stroke="black" d="M288.5,-807.6C366.86,-794.91 506.45,-772.29 622.05,-753.57"/>
<polygon fill="black" stroke="black" points="622.35,-757.06 631.66,-752.01 621.23,-750.15 622.35,-757.06"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-779.64" font-family="Times,serif" font-size="14.00">for 5</text>
</g>
<!-- layers.3.mlp -->
<g id="node58" class="node">
<title>layers.3.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-1055.5" rx="73.3" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-1050.83" font-family="Times,serif" font-size="14.00">layers.3.mlp</text>
</g>
<!-- layers.3.mlp&#45;&gt;DeepseekV2MLP @ layers.3.mlp.experts[0..52] -->
<g id="edge8" class="edge">
<title>layers.3.mlp&#45;&gt;DeepseekV2MLP @ layers.3.mlp.experts[0..52]</title>
<path fill="none" stroke="black" d="M296.68,-1061.05C377.42,-1067.52 514.12,-1078.48 626.7,-1087.5"/>
<polygon fill="black" stroke="black" points="626.11,-1090.97 636.35,-1088.28 626.67,-1083.99 626.11,-1090.97"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-1084.36" font-family="Times,serif" font-size="14.00">for 53</text>
</g>
<!-- layers.3.mlp&#45;&gt;DeepseekV2MLP @ layers.3.mlp.experts[54..63] -->
<g id="edge9" class="edge">
<title>layers.3.mlp&#45;&gt;DeepseekV2MLP @ layers.3.mlp.experts[54..63]</title>
<path fill="none" stroke="black" d="M296.39,-1049.85C375.94,-1043.34 510.09,-1032.36 621.86,-1023.21"/>
<polygon fill="black" stroke="black" points="622.1,-1026.7 631.78,-1022.4 621.53,-1019.73 622.1,-1026.7"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-1038.32" font-family="Times,serif" font-size="14.00">for 10</text>
</g>
<!-- layers.4.mlp -->
<g id="node59" class="node">
<title>layers.4.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-1197.5" rx="73.3" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-1192.83" font-family="Times,serif" font-size="14.00">layers.4.mlp</text>
</g>
<!-- layers.4.mlp&#45;&gt;DeepseekV2MLP @ layers.4.mlp.experts[0..63] -->
<g id="edge10" class="edge">
<title>layers.4.mlp&#45;&gt;DeepseekV2MLP @ layers.4.mlp.experts[0..63]</title>
<path fill="none" stroke="black" d="M300.19,-1197.5C381.22,-1197.5 515.37,-1197.5 626.25,-1197.5"/>
<polygon fill="black" stroke="black" points="626.08,-1201 636.08,-1197.5 626.08,-1194 626.08,-1201"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-1201.45" font-family="Times,serif" font-size="14.00">for 64</text>
</g>
<!-- layers.5.mlp -->
<g id="node60" class="node">
<title>layers.5.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-1292.5" rx="73.3" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-1287.83" font-family="Times,serif" font-size="14.00">layers.5.mlp</text>
</g>
<!-- layers.5.mlp&#45;&gt;DeepseekV2MLP @ layers.5.mlp.experts[0..63] -->
<g id="edge11" class="edge">
<title>layers.5.mlp&#45;&gt;DeepseekV2MLP @ layers.5.mlp.experts[0..63]</title>
<path fill="none" stroke="black" d="M300.19,-1292.5C381.22,-1292.5 515.37,-1292.5 626.25,-1292.5"/>
<polygon fill="black" stroke="black" points="626.08,-1296 636.08,-1292.5 626.08,-1289 626.08,-1296"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-1296.45" font-family="Times,serif" font-size="14.00">for 64</text>
</g>
<!-- layers.6.mlp -->
<g id="node61" class="node">
<title>layers.6.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-1387.5" rx="73.3" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-1382.83" font-family="Times,serif" font-size="14.00">layers.6.mlp</text>
</g>
<!-- layers.6.mlp&#45;&gt;DeepseekV2MLP @ layers.6.mlp.experts[0..63] -->
<g id="edge12" class="edge">
<title>layers.6.mlp&#45;&gt;DeepseekV2MLP @ layers.6.mlp.experts[0..63]</title>
<path fill="none" stroke="black" d="M300.19,-1387.5C381.22,-1387.5 515.37,-1387.5 626.25,-1387.5"/>
<polygon fill="black" stroke="black" points="626.08,-1391 636.08,-1387.5 626.08,-1384 626.08,-1391"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-1391.45" font-family="Times,serif" font-size="14.00">for 64</text>
</g>
<!-- layers.7.mlp -->
<g id="node62" class="node">
<title>layers.7.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-1482.5" rx="73.3" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-1477.83" font-family="Times,serif" font-size="14.00">layers.7.mlp</text>
</g>
<!-- layers.7.mlp&#45;&gt;DeepseekV2MLP @ layers.7.mlp.experts[0..63] -->
<g id="edge13" class="edge">
<title>layers.7.mlp&#45;&gt;DeepseekV2MLP @ layers.7.mlp.experts[0..63]</title>
<path fill="none" stroke="black" d="M300.19,-1482.5C381.22,-1482.5 515.37,-1482.5 626.25,-1482.5"/>
<polygon fill="black" stroke="black" points="626.08,-1486 636.08,-1482.5 626.08,-1479 626.08,-1486"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-1486.45" font-family="Times,serif" font-size="14.00">for 64</text>
</g>
<!-- layers.8.mlp -->
<g id="node63" class="node">
<title>layers.8.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-1625.5" rx="73.3" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-1620.83" font-family="Times,serif" font-size="14.00">layers.8.mlp</text>
</g>
<!-- layers.8.mlp&#45;&gt;DeepseekV2MLP @ layers.8.mlp.experts[0..5] -->
<g id="edge14" class="edge">
<title>layers.8.mlp&#45;&gt;DeepseekV2MLP @ layers.8.mlp.experts[0..5]</title>
<path fill="none" stroke="black" d="M296.68,-1631.05C378.44,-1637.61 517.6,-1648.76 630.98,-1657.85"/>
<polygon fill="black" stroke="black" points="630.46,-1661.32 640.71,-1658.63 631.02,-1654.34 630.46,-1661.32"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-1654.36" font-family="Times,serif" font-size="14.00">for 6</text>
</g>
<!-- layers.8.mlp&#45;&gt;DeepseekV2MLP @ layers.8.mlp.experts[7..63] -->
<g id="edge15" class="edge">
<title>layers.8.mlp&#45;&gt;DeepseekV2MLP @ layers.8.mlp.experts[7..63]</title>
<path fill="none" stroke="black" d="M296.39,-1619.85C377.04,-1613.25 513.83,-1602.05 626.51,-1592.83"/>
<polygon fill="black" stroke="black" points="626.49,-1596.34 636.17,-1592.04 625.92,-1589.37 626.49,-1596.34"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-1608.32" font-family="Times,serif" font-size="14.00">for 57</text>
</g>
<!-- layers.9.mlp -->
<g id="node64" class="node">
<title>layers.9.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-1767.5" rx="73.3" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-1762.83" font-family="Times,serif" font-size="14.00">layers.9.mlp</text>
</g>
<!-- layers.9.mlp&#45;&gt;DeepseekV2MLP @ layers.9.mlp.experts[0..63] -->
<g id="edge16" class="edge">
<title>layers.9.mlp&#45;&gt;DeepseekV2MLP @ layers.9.mlp.experts[0..63]</title>
<path fill="none" stroke="black" d="M300.19,-1767.5C381.22,-1767.5 515.37,-1767.5 626.25,-1767.5"/>
<polygon fill="black" stroke="black" points="626.08,-1771 636.08,-1767.5 626.08,-1764 626.08,-1771"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-1771.45" font-family="Times,serif" font-size="14.00">for 64</text>
</g>
<!-- layers.10.mlp -->
<g id="node65" class="node">
<title>layers.10.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-1862.5" rx="79.62" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-1857.83" font-family="Times,serif" font-size="14.00">layers.10.mlp</text>
</g>
<!-- layers.10.mlp&#45;&gt;DeepseekV2MLP @ layers.10.mlp.experts[0..63] -->
<g id="edge17" class="edge">
<title>layers.10.mlp&#45;&gt;DeepseekV2MLP @ layers.10.mlp.experts[0..63]</title>
<path fill="none" stroke="black" d="M306.49,-1862.5C386.95,-1862.5 514.73,-1862.5 621.91,-1862.5"/>
<polygon fill="black" stroke="black" points="621.69,-1866 631.69,-1862.5 621.69,-1859 621.69,-1866"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-1866.45" font-family="Times,serif" font-size="14.00">for 64</text>
</g>
<!-- layers.11.mlp -->
<g id="node66" class="node">
<title>layers.11.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-1957.5" rx="79.62" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-1952.83" font-family="Times,serif" font-size="14.00">layers.11.mlp</text>
</g>
<!-- layers.11.mlp&#45;&gt;DeepseekV2MLP @ layers.11.mlp.experts[0..63] -->
<g id="edge18" class="edge">
<title>layers.11.mlp&#45;&gt;DeepseekV2MLP @ layers.11.mlp.experts[0..63]</title>
<path fill="none" stroke="black" d="M306.49,-1957.5C386.95,-1957.5 514.73,-1957.5 621.91,-1957.5"/>
<polygon fill="black" stroke="black" points="621.69,-1961 631.69,-1957.5 621.69,-1954 621.69,-1961"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-1961.45" font-family="Times,serif" font-size="14.00">for 64</text>
</g>
<!-- sam_model.patch_embed -->
<g id="node67" class="node">
<title>sam_model.patch_embed</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-2052.5" rx="136.44" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-2047.83" font-family="Times,serif" font-size="14.00">sam_model.patch_embed</text>
</g>
<!-- sam_model.patch_embed&#45;&gt;Conv2d @ sam_model.patch_embed.proj -->
<g id="edge20" class="edge">
<title>sam_model.patch_embed&#45;&gt;Conv2d @ sam_model.patch_embed.proj</title>
<path fill="none" stroke="black" d="M363.04,-2052.5C448.77,-2052.5 560.06,-2052.5 650.61,-2052.5"/>
<polygon fill="black" stroke="black" points="650.59,-2056 660.59,-2052.5 650.59,-2049 650.59,-2056"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-2056.45" font-family="Times,serif" font-size="14.00">parfor 2</text>
</g>
<!-- sam_model.blocks.* -->
<g id="node68" class="node">
<title>sam_model.blocks.*</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-2290.5" rx="109.61" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-2285.82" font-family="Times,serif" font-size="14.00">sam_model.blocks.*</text>
</g>
<!-- sam_model.blocks.*&#45;&gt;LayerNorm @ sam_model.blocks.*.norm1 -->
<g id="edge21" class="edge">
<title>sam_model.blocks.*&#45;&gt;LayerNorm @ sam_model.blocks.*.norm1</title>
<path fill="none" stroke="black" d="M281.67,-2306.47C349.58,-2326.16 469.6,-2360.03 573.56,-2384.5 597.45,-2390.12 622.78,-2395.65 647.68,-2400.84"/>
<polygon fill="black" stroke="black" points="646.72,-2404.22 657.22,-2402.81 648.14,-2397.36 646.72,-2404.22"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-2383.97" font-family="Times,serif" font-size="14.00">parfor 24</text>
</g>
<!-- sam_model.blocks.*&#45;&gt;Attention @ sam_model.blocks.*.attn -->
<g id="edge22" class="edge">
<title>sam_model.blocks.*&#45;&gt;Attention @ sam_model.blocks.*.attn</title>
<path fill="none" stroke="black" d="M325.88,-2298.39C418.03,-2305.78 557,-2316.92 663.09,-2325.42"/>
<polygon fill="black" stroke="black" points="662.8,-2328.91 673.05,-2326.22 663.36,-2321.93 662.8,-2328.91"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-2319.36" font-family="Times,serif" font-size="14.00">parfor 1160</text>
</g>
<!-- sam_model.blocks.*&#45;&gt;LayerNorm @ sam_model.blocks.*.norm2 -->
<g id="edge25" class="edge">
<title>sam_model.blocks.*&#45;&gt;LayerNorm @ sam_model.blocks.*.norm2</title>
<path fill="none" stroke="black" d="M325.55,-2282.47C413.24,-2275.29 543.53,-2264.62 647.47,-2256.12"/>
<polygon fill="black" stroke="black" points="647.53,-2259.62 657.21,-2255.32 646.96,-2252.65 647.53,-2259.62"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-2273.32" font-family="Times,serif" font-size="14.00">parfor 24</text>
</g>
<!-- sam_model.blocks.*&#45;&gt;MLPBlock @ sam_model.blocks.*.mlp -->
<g id="edge26" class="edge">
<title>sam_model.blocks.*&#45;&gt;MLPBlock @ sam_model.blocks.*.mlp</title>
<path fill="none" stroke="black" d="M280.44,-2274.41C348.09,-2254.21 468.86,-2219.22 573.56,-2194.5 601.98,-2187.79 632.46,-2181.29 661.84,-2175.38"/>
<polygon fill="black" stroke="black" points="662.43,-2178.83 671.55,-2173.44 661.06,-2171.97 662.43,-2178.83"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-2222.52" font-family="Times,serif" font-size="14.00">parfor 72</text>
</g>
<!-- sam_model.blocks.*.attn -->
<g id="node69" class="node">
<title>sam_model.blocks.*.attn</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-2575.5" rx="133.28" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-2570.82" font-family="Times,serif" font-size="14.00">sam_model.blocks.*.attn</text>
</g>
<!-- sam_model.blocks.*.attn&#45;&gt;Linear @ sam_model.blocks.*.attn.qkv -->
<g id="edge23" class="edge">
<title>sam_model.blocks.*.attn&#45;&gt;Linear @ sam_model.blocks.*.attn.qkv</title>
<path fill="none" stroke="black" d="M342.21,-2584.7C432.5,-2591.94 559.22,-2602.09 658.56,-2610.06"/>
<polygon fill="black" stroke="black" points="658.17,-2613.54 668.41,-2610.85 658.73,-2606.56 658.17,-2613.54"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-2604.36" font-family="Times,serif" font-size="14.00">parfor 24</text>
</g>
<!-- sam_model.blocks.*.attn&#45;&gt;Linear @ sam_model.blocks.*.attn.proj -->
<g id="edge24" class="edge">
<title>sam_model.blocks.*.attn&#45;&gt;Linear @ sam_model.blocks.*.attn.proj</title>
<path fill="none" stroke="black" d="M341.51,-2566.16C431.42,-2558.8 557.75,-2548.46 657.14,-2540.32"/>
<polygon fill="black" stroke="black" points="657.31,-2543.82 667,-2539.52 656.74,-2536.84 657.31,-2543.82"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-2558.32" font-family="Times,serif" font-size="14.00">parfor 24</text>
</g>
<!-- sam_model.blocks.*.mlp -->
<g id="node70" class="node">
<title>sam_model.blocks.*.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-2812.5" rx="131.7" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-2807.82" font-family="Times,serif" font-size="14.00">sam_model.blocks.*.mlp</text>
</g>
<!-- sam_model.blocks.*.mlp&#45;&gt;Linear @ sam_model.blocks.*.mlp.lin1 -->
<g id="edge27" class="edge">
<title>sam_model.blocks.*.mlp&#45;&gt;Linear @ sam_model.blocks.*.mlp.lin1</title>
<path fill="none" stroke="black" d="M313.3,-2826.42C403.88,-2841.09 548.49,-2864.52 659.03,-2882.43"/>
<polygon fill="black" stroke="black" points="658.37,-2885.87 668.81,-2884.01 659.49,-2878.96 658.37,-2885.87"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-2866.8" font-family="Times,serif" font-size="14.00">parfor 24</text>
</g>
<!-- sam_model.blocks.*.mlp&#45;&gt;GELU @ sam_model.blocks.*.mlp.act -->
<g id="edge28" class="edge">
<title>sam_model.blocks.*.mlp&#45;&gt;GELU @ sam_model.blocks.*.mlp.act</title>
<path fill="none" stroke="black" d="M358.27,-2812.5C448.69,-2812.5 569.18,-2812.5 663.53,-2812.5"/>
<polygon fill="black" stroke="black" points="663.39,-2816 673.39,-2812.5 663.39,-2809 663.39,-2816"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-2816.45" font-family="Times,serif" font-size="14.00">parfor 24</text>
</g>
<!-- sam_model.blocks.*.mlp&#45;&gt;Linear @ sam_model.blocks.*.mlp.lin2 -->
<g id="edge29" class="edge">
<title>sam_model.blocks.*.mlp&#45;&gt;Linear @ sam_model.blocks.*.mlp.lin2</title>
<path fill="none" stroke="black" d="M313.3,-2798.58C403.88,-2783.91 548.49,-2760.48 659.03,-2742.57"/>
<polygon fill="black" stroke="black" points="659.49,-2746.04 668.81,-2740.99 658.37,-2739.13 659.49,-2746.04"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-2774.64" font-family="Times,serif" font-size="14.00">parfor 24</text>
</g>
<!-- vision_model -->
<g id="node71" class="node">
<title>vision_model</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-3097.5" rx="75.94" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-3092.82" font-family="Times,serif" font-size="14.00">vision_model</text>
</g>
<!-- vision_model&#45;&gt;CLIPVisionEmbeddings @ vision_model.embeddings -->
<g id="edge32" class="edge">
<title>vision_model&#45;&gt;CLIPVisionEmbeddings @ vision_model.embeddings</title>
<path fill="none" stroke="black" d="M290.16,-3107.67C365.72,-3119.91 496.44,-3141.08 608.36,-3159.22"/>
<polygon fill="black" stroke="black" points="607.55,-3162.63 617.98,-3160.78 608.67,-3155.72 607.55,-3162.63"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-3151.8" font-family="Times,serif" font-size="14.00">parfor 30</text>
</g>
<!-- vision_model&#45;&gt;LayerNorm @ vision_model.pre_layrnorm -->
<g id="edge34" class="edge">
<title>vision_model&#45;&gt;LayerNorm @ vision_model.pre_layrnorm</title>
<path fill="none" stroke="black" d="M302.57,-3097.5C388.93,-3097.5 533.31,-3097.5 646.65,-3097.5"/>
<polygon fill="black" stroke="black" points="646.36,-3101 656.36,-3097.5 646.36,-3094 646.36,-3101"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-3101.45" font-family="Times,serif" font-size="14.00">parfor 2</text>
</g>
<!-- vision_model&#45;&gt;NoTPTransformer @ vision_model.transformer -->
<g id="edge35" class="edge">
<title>vision_model&#45;&gt;NoTPTransformer @ vision_model.transformer</title>
<path fill="none" stroke="black" d="M290.16,-3087.33C370.23,-3074.36 512.25,-3051.35 628.2,-3032.57"/>
<polygon fill="black" stroke="black" points="628.53,-3036.06 637.84,-3031.01 627.41,-3029.15 628.53,-3036.06"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-3059.64" font-family="Times,serif" font-size="14.00">parfor 1152</text>
</g>
<!-- vision_model.embeddings -->
<g id="node72" class="node">
<title>vision_model.embeddings</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-3287.5" rx="140.12" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-3282.82" font-family="Times,serif" font-size="14.00">vision_model.embeddings</text>
</g>
<!-- vision_model.embeddings&#45;&gt;Embedding @ vision_model.embeddings.position_embedding -->
<g id="edge33" class="edge">
<title>vision_model.embeddings&#45;&gt;Embedding @ vision_model.embeddings.position_embedding</title>
<path fill="none" stroke="black" d="M366.74,-3287.5C429.52,-3287.5 505.43,-3287.5 576.74,-3287.5"/>
<polygon fill="black" stroke="black" points="576.62,-3291 586.62,-3287.5 576.62,-3284 576.62,-3291"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-3291.45" font-family="Times,serif" font-size="14.00">parfor 4</text>
</g>
<!-- vision_model.transformer.layers.* -->
<g id="node73" class="node">
<title>vision_model.transformer.layers.*</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-3525.5" rx="180.1" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-3520.82" font-family="Times,serif" font-size="14.00">vision_model.transformer.layers.*</text>
</g>
<!-- vision_model.transformer.layers.*&#45;&gt;LayerNorm @ vision_model.transformer.layers.*.layer_norm1 -->
<g id="edge36" class="edge">
<title>vision_model.transformer.layers.*&#45;&gt;LayerNorm @ vision_model.transformer.layers.*.layer_norm1</title>
<path fill="none" stroke="black" d="M285.55,-3542.89C354.06,-3563.04 471.48,-3596.54 573.56,-3620.5 581.61,-3622.39 589.83,-3624.27 598.14,-3626.12"/>
<polygon fill="black" stroke="black" points="597.12,-3629.47 607.64,-3628.21 598.63,-3622.64 597.12,-3629.47"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-3619.97" font-family="Times,serif" font-size="14.00">parfor 48</text>
</g>
<!-- vision_model.transformer.layers.*&#45;&gt;NoTPAttention @ vision_model.transformer.layers.*.self_attn -->
<g id="edge37" class="edge">
<title>vision_model.transformer.layers.*&#45;&gt;NoTPAttention @ vision_model.transformer.layers.*.self_attn</title>
<path fill="none" stroke="black" d="M368.98,-3536.85C431.72,-3541.88 507.23,-3547.93 578.08,-3553.61"/>
<polygon fill="black" stroke="black" points="577.65,-3557.08 587.9,-3554.39 578.21,-3550.11 577.65,-3557.08"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-3554.36" font-family="Times,serif" font-size="14.00">parfor 720</text>
</g>
<!-- vision_model.transformer.layers.*&#45;&gt;LayerNorm @ vision_model.transformer.layers.*.layer_norm2 -->
<g id="edge40" class="edge">
<title>vision_model.transformer.layers.*&#45;&gt;LayerNorm @ vision_model.transformer.layers.*.layer_norm2</title>
<path fill="none" stroke="black" d="M367.86,-3514C430.18,-3508.9 505.26,-3502.76 575.9,-3496.97"/>
<polygon fill="black" stroke="black" points="576.01,-3500.48 585.69,-3496.17 575.44,-3493.5 576.01,-3500.48"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-3508.32" font-family="Times,serif" font-size="14.00">parfor 48</text>
</g>
<!-- vision_model.transformer.layers.*&#45;&gt;NoTPFeedForward @ vision_model.transformer.layers.*.mlp -->
<g id="edge41" class="edge">
<title>vision_model.transformer.layers.*&#45;&gt;NoTPFeedForward @ vision_model.transformer.layers.*.mlp</title>
<path fill="none" stroke="black" d="M285.88,-3508.09C354.44,-3488 471.68,-3454.63 573.56,-3430.5 582.95,-3428.27 592.57,-3426.07 602.3,-3423.89"/>
<polygon fill="black" stroke="black" points="602.85,-3427.35 611.85,-3421.77 601.33,-3420.52 602.85,-3427.35"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-3458.45" font-family="Times,serif" font-size="14.00">parfor 240</text>
</g>
<!-- vision_model.transformer.layers.*.self_attn -->
<g id="node74" class="node">
<title>vision_model.transformer.layers.*.self_attn</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-3810.5" rx="226.4" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-3805.82" font-family="Times,serif" font-size="14.00">vision_model.transformer.layers.*.self_attn</text>
</g>
<!-- vision_model.transformer.layers.*.self_attn&#45;&gt;Linear @ vision_model.transformer.layers.*.self_attn.qkv_proj -->
<g id="edge38" class="edge">
<title>vision_model.transformer.layers.*.self_attn&#45;&gt;Linear @ vision_model.transformer.layers.*.self_attn.qkv_proj</title>
<path fill="none" stroke="black" d="M388.42,-3823.41C445.91,-3828.01 511.98,-3833.31 574.64,-3838.33"/>
<polygon fill="black" stroke="black" points="574.13,-3841.8 584.38,-3839.11 574.69,-3834.82 574.13,-3841.8"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-3839.36" font-family="Times,serif" font-size="14.00">parfor 48</text>
</g>
<!-- vision_model.transformer.layers.*.self_attn&#45;&gt;Linear @ vision_model.transformer.layers.*.self_attn.out_proj -->
<g id="edge39" class="edge">
<title>vision_model.transformer.layers.*.self_attn&#45;&gt;Linear @ vision_model.transformer.layers.*.self_attn.out_proj</title>
<path fill="none" stroke="black" d="M386.87,-3797.45C445.01,-3792.69 512.1,-3787.2 575.61,-3782"/>
<polygon fill="black" stroke="black" points="575.81,-3785.49 585.5,-3781.19 575.24,-3778.52 575.81,-3785.49"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-3793.32" font-family="Times,serif" font-size="14.00">parfor 48</text>
</g>
<!-- vision_model.transformer.layers.*.mlp -->
<g id="node75" class="node">
<title>vision_model.transformer.layers.*.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-4000.5" rx="202.2" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-3995.82" font-family="Times,serif" font-size="14.00">vision_model.transformer.layers.*.mlp</text>
</g>
<!-- vision_model.transformer.layers.*.mlp&#45;&gt;Linear @ vision_model.transformer.layers.*.mlp.fc1 -->
<g id="edge42" class="edge">
<title>vision_model.transformer.layers.*.mlp&#45;&gt;Linear @ vision_model.transformer.layers.*.mlp.fc1</title>
<path fill="none" stroke="black" d="M378.8,-4012.63C449.71,-4018.32 535.21,-4025.17 611.56,-4031.29"/>
<polygon fill="black" stroke="black" points="611,-4034.76 621.25,-4032.07 611.56,-4027.78 611,-4034.76"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-4029.36" font-family="Times,serif" font-size="14.00">parfor 48</text>
</g>
<!-- vision_model.transformer.layers.*.mlp&#45;&gt;Linear @ vision_model.transformer.layers.*.mlp.fc2 -->
<g id="edge43" class="edge">
<title>vision_model.transformer.layers.*.mlp&#45;&gt;Linear @ vision_model.transformer.layers.*.mlp.fc2</title>
<path fill="none" stroke="black" d="M377.65,-3988.2C448.73,-3982.38 534.64,-3975.35 611.36,-3969.07"/>
<polygon fill="black" stroke="black" points="611.42,-3972.58 621.1,-3968.27 610.85,-3965.6 611.42,-3972.58"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-3983.32" font-family="Times,serif" font-size="14.00">parfor 48</text>
</g>
<!-- projector -->
<g id="node76" class="node">
<title>projector</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-4133.5" rx="57" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-4128.82" font-family="Times,serif" font-size="14.00">projector</text>
</g>
<!-- projector&#45;&gt;Linear @ projector.layers -->
<g id="edge44" class="edge">
<title>projector&#45;&gt;Linear @ projector.layers</title>
<path fill="none" stroke="black" d="M283.9,-4133.5C380.69,-4133.5 579.86,-4133.5 704.55,-4133.5"/>
<polygon fill="black" stroke="black" points="704.5,-4137 714.5,-4133.5 704.5,-4130 704.5,-4137"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-4137.45" font-family="Times,serif" font-size="14.00">parfor 2</text>
</g>
<!-- layers.* -->
<g id="node77" class="node">
<title>layers.*</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-4362.5" rx="49.63" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-4357.82" font-family="Times,serif" font-size="14.00">layers.*</text>
</g>
<!-- layers.*&#45;&gt;DeepseekV2RMSNorm @ layers.*.input_layernorm -->
<g id="edge45" class="edge">
<title>layers.*&#45;&gt;DeepseekV2RMSNorm @ layers.*.input_layernorm</title>
<path fill="none" stroke="black" d="M265.58,-4373.98C329.11,-4392.87 460.71,-4431.02 573.56,-4457.5 586.7,-4460.58 600.27,-4463.63 613.98,-4466.59"/>
<polygon fill="black" stroke="black" points="613,-4469.96 623.51,-4468.63 614.47,-4463.11 613,-4469.96"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-4456.97" font-family="Times,serif" font-size="14.00">parfor 96</text>
</g>
<!-- layers.*&#45;&gt;LlamaAttention @ layers.*.self_attn -->
<g id="edge46" class="edge">
<title>layers.*&#45;&gt;LlamaAttention @ layers.*.self_attn</title>
<path fill="none" stroke="black" d="M275.39,-4366.35C360.24,-4373.15 539.92,-4387.55 668.37,-4397.84"/>
<polygon fill="black" stroke="black" points="667.71,-4401.3 677.96,-4398.61 668.27,-4394.32 667.71,-4401.3"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-4391.36" font-family="Times,serif" font-size="14.00">parfor 792</text>
</g>
<!-- layers.*&#45;&gt;DeepseekV2RMSNorm @ layers.*.post_attention_layernorm -->
<g id="edge48" class="edge">
<title>layers.*&#45;&gt;DeepseekV2RMSNorm @ layers.*.post_attention_layernorm</title>
<path fill="none" stroke="black" d="M274.89,-4358.61C341.59,-4353.15 467.56,-4342.84 580.94,-4333.56"/>
<polygon fill="black" stroke="black" points="581.04,-4337.07 590.72,-4332.76 580.46,-4330.09 581.04,-4337.07"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-4345.32" font-family="Times,serif" font-size="14.00">parfor 96</text>
</g>
<!-- layers.*&#45;&gt;DeepseekV2MLP @ layers.*.mlp -->
<g id="edge49" class="edge">
<title>layers.*&#45;&gt;DeepseekV2MLP @ layers.*.mlp</title>
<path fill="none" stroke="black" d="M265.59,-4351.07C329.14,-4332.26 460.76,-4294.21 573.56,-4267.5 607.92,-4259.36 645.25,-4251.46 680.03,-4244.49"/>
<polygon fill="black" stroke="black" points="680.61,-4247.94 689.74,-4242.55 679.25,-4241.07 680.61,-4247.94"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-4295.45" font-family="Times,serif" font-size="14.00">parfor 4579</text>
</g>
<!-- layers.*.self_attn -->
<g id="node78" class="node">
<title>layers.*.self_attn</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-4599.5" rx="95.93" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-4594.82" font-family="Times,serif" font-size="14.00">layers.*.self_attn</text>
</g>
<!-- layers.*.self_attn&#45;&gt;LlamaRotaryEmbedding @ layers.*.self_attn.rotary_emb -->
<g id="edge47" class="edge">
<title>layers.*.self_attn&#45;&gt;LlamaRotaryEmbedding @ layers.*.self_attn.rotary_emb</title>
<path fill="none" stroke="black" d="M322.6,-4599.5C395.76,-4599.5 499.81,-4599.5 593.32,-4599.5"/>
<polygon fill="black" stroke="black" points="593.16,-4603 603.16,-4599.5 593.16,-4596 593.16,-4603"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-4603.45" font-family="Times,serif" font-size="14.00">parfor 204</text>
</g>
<!-- layers.*.mlp -->
<g id="node79" class="node">
<title>layers.*.mlp</title>
<ellipse fill="none" stroke="black" cx="226.4" cy="-4741.5" rx="71.73" ry="18"/>
<text xml:space="preserve" text-anchor="middle" x="226.4" y="-4736.82" font-family="Times,serif" font-size="14.00">layers.*.mlp</text>
</g>
<!-- layers.*.mlp&#45;&gt;MoEGate @ layers.*.mlp.gate -->
<g id="edge50" class="edge">
<title>layers.*.mlp&#45;&gt;MoEGate @ layers.*.mlp.gate</title>
<path fill="none" stroke="black" d="M295.24,-4747.05C391.33,-4754.92 568.73,-4769.44 688.98,-4779.28"/>
<polygon fill="black" stroke="black" points="688.67,-4782.77 698.93,-4780.1 689.25,-4775.79 688.67,-4782.77"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-4770.89" font-family="Times,serif" font-size="14.00">parfor 88</text>
</g>
<!-- layers.*.mlp&#45;&gt;DeepseekV2MLP @ layers.*.mlp.shared_experts -->
<g id="edge51" class="edge">
<title>layers.*.mlp&#45;&gt;DeepseekV2MLP @ layers.*.mlp.shared_experts</title>
<path fill="none" stroke="black" d="M295.24,-4736.06C374.97,-4729.67 510.67,-4718.8 623.26,-4709.77"/>
<polygon fill="black" stroke="black" points="623.23,-4713.29 632.92,-4709 622.67,-4706.31 623.23,-4713.29"/>
<text xml:space="preserve" text-anchor="middle" x="513.18" y="-4724.76" font-family="Times,serif" font-size="14.00">parfor 55</text>
</g>
</g>
</svg>
