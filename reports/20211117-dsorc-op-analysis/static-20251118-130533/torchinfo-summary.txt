===================================================================================================================================================================================================
Layer (type (var_name):depth-idx)                                      Input Shape               Output Shape              Param #                   Kernel Shape              Mult-Adds
===================================================================================================================================================================================================
DeepseekOCRModel (DeepseekOCRModel)                                    --                        [1, 10, 703, 128]         2,560                     --                        --
├─Embedding (embed_tokens): 1-1                                        [1, 703]                  [1, 703, 1280]            165,478,400               --                        165,478,400
├─ImageEncoderViT (sam_model): 1-2                                     [4, 3, 640, 640]          [4, 1024, 10, 10]         3,145,728                 --                        --
│    └─PatchEmbed (patch_embed): 2-1                                   [4, 3, 640, 640]          [4, 40, 40, 768]          --                        --                        --
│    │    └─Conv2d (proj): 3-1                                         [4, 3, 640, 640]          [4, 768, 40, 40]          590,592                   [16, 16]                  3,779,788,800
│    └─ModuleList (blocks): 2-11                                       --                        --                        (recursive)               --                        --
│    │    └─Block (0): 3-2                                             [4, 40, 40, 768]          [4, 40, 40, 768]          7,091,328                 --                        103,947,264
│    │    └─Block (1): 3-3                                             [4, 40, 40, 768]          [4, 40, 40, 768]          7,091,328                 --                        103,947,264
│    │    └─Block (2): 3-4                                             [4, 40, 40, 768]          [4, 40, 40, 768]          7,104,128                 --                        28,351,488
│    │    └─Block (3): 3-5                                             [4, 40, 40, 768]          [4, 40, 40, 768]          7,091,328                 --                        103,947,264
│    │    └─Block (4): 3-6                                             [4, 40, 40, 768]          [4, 40, 40, 768]          7,091,328                 --                        103,947,264
│    │    └─Block (5): 3-7                                             [4, 40, 40, 768]          [4, 40, 40, 768]          7,104,128                 --                        28,351,488
│    │    └─Block (6): 3-8                                             [4, 40, 40, 768]          [4, 40, 40, 768]          7,091,328                 --                        103,947,264
│    │    └─Block (7): 3-9                                             [4, 40, 40, 768]          [4, 40, 40, 768]          7,091,328                 --                        103,947,264
│    │    └─Block (8): 3-10                                            [4, 40, 40, 768]          [4, 40, 40, 768]          7,104,128                 --                        28,351,488
│    │    └─Block (9): 3-11                                            [4, 40, 40, 768]          [4, 40, 40, 768]          7,091,328                 --                        103,947,264
│    │    └─Block (10): 3-12                                           [4, 40, 40, 768]          [4, 40, 40, 768]          7,091,328                 --                        103,947,264
│    │    └─Block (11): 3-13                                           [4, 40, 40, 768]          [4, 40, 40, 768]          7,104,128                 --                        28,351,488
│    └─Sequential (neck): 2-3                                          [4, 768, 40, 40]          [4, 256, 40, 40]          --                        --                        --
│    │    └─Conv2d (0): 3-14                                           [4, 768, 40, 40]          [4, 256, 40, 40]          196,608                   [1, 1]                    1,258,291,200
│    │    └─LayerNorm2d (1): 3-15                                      [4, 256, 40, 40]          [4, 256, 40, 40]          512                       --                        2,048
│    │    └─Conv2d (2): 3-16                                           [4, 256, 40, 40]          [4, 256, 40, 40]          589,824                   [3, 3]                    3,774,873,600
│    │    └─LayerNorm2d (3): 3-17                                      [4, 256, 40, 40]          [4, 256, 40, 40]          512                       --                        2,048
│    └─Conv2d (net_2): 2-4                                             [4, 256, 40, 40]          [4, 512, 20, 20]          1,179,648                 [3, 3]                    1,887,436,800
│    └─Conv2d (net_3): 2-5                                             [4, 512, 20, 20]          [4, 1024, 10, 10]         4,718,592                 [3, 3]                    1,887,436,800
├─VitModel (vision_model): 1-3                                         [4, 3, 640, 640]          [4, 101, 1024]            --                        --                        --
│    └─CLIPVisionEmbeddings (embeddings): 2-6                          [4, 3, 640, 640]          [4, 101, 1024]            603,136                   --                        --
│    │    └─Embedding (position_embedding): 3-18                       [1, 257]                  [1, 257, 1024]            263,168                   --                        263,168
│    └─LayerNorm (pre_layrnorm): 2-7                                   [4, 101, 1024]            [4, 101, 1024]            2,048                     --                        8,192
│    └─NoTPTransformer (transformer): 2-8                              [4, 101, 1024]            [4, 101, 1024]            --                        --                        --
│    │    └─ModuleList (layers): 3-38                                  --                        --                        (recursive)               --                        --
├─MlpProjector (projector): 1-4                                        [4, 100, 2048]            [4, 100, 1280]            --                        --                        --
│    └─Linear (layers): 2-9                                            [4, 100, 2048]            [4, 100, 1280]            2,622,720                 --                        10,490,880
├─ImageEncoderViT (sam_model): 1-5                                     [1, 3, 1024, 1024]        [1, 1024, 16, 16]         (recursive)               --                        --
│    └─PatchEmbed (patch_embed): 2-10                                  [1, 3, 1024, 1024]        [1, 64, 64, 768]          (recursive)               --                        --
│    │    └─Conv2d (proj): 3-20                                        [1, 3, 1024, 1024]        [1, 768, 64, 64]          (recursive)               [16, 16]                  2,419,064,832
│    └─ModuleList (blocks): 2-11                                       --                        --                        (recursive)               --                        --
│    │    └─Block (0): 3-21                                            [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        63,784,704
│    │    └─Block (1): 3-22                                            [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        63,784,704
│    │    └─Block (2): 3-23                                            [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        7,087,872
│    │    └─Block (3): 3-24                                            [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        63,784,704
│    │    └─Block (4): 3-25                                            [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        63,784,704
│    │    └─Block (5): 3-26                                            [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        7,087,872
│    │    └─Block (6): 3-27                                            [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        63,784,704
│    │    └─Block (7): 3-28                                            [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        63,784,704
│    │    └─Block (8): 3-29                                            [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        7,087,872
│    │    └─Block (9): 3-30                                            [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        63,784,704
│    │    └─Block (10): 3-31                                           [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        63,784,704
│    │    └─Block (11): 3-32                                           [1, 64, 64, 768]          [1, 64, 64, 768]          (recursive)               --                        7,087,872
│    └─Sequential (neck): 2-12                                         [1, 768, 64, 64]          [1, 256, 64, 64]          (recursive)               --                        --
│    │    └─Conv2d (0): 3-33                                           [1, 768, 64, 64]          [1, 256, 64, 64]          (recursive)               [1, 1]                    805,306,368
│    │    └─LayerNorm2d (1): 3-34                                      [1, 256, 64, 64]          [1, 256, 64, 64]          (recursive)               --                        512
│    │    └─Conv2d (2): 3-35                                           [1, 256, 64, 64]          [1, 256, 64, 64]          (recursive)               [3, 3]                    2,415,919,104
│    │    └─LayerNorm2d (3): 3-36                                      [1, 256, 64, 64]          [1, 256, 64, 64]          (recursive)               --                        512
│    └─Conv2d (net_2): 2-13                                            [1, 256, 64, 64]          [1, 512, 32, 32]          (recursive)               [3, 3]                    1,207,959,552
│    └─Conv2d (net_3): 2-14                                            [1, 512, 32, 32]          [1, 1024, 16, 16]         (recursive)               [3, 3]                    1,207,959,552
├─VitModel (vision_model): 1-6                                         [1, 3, 1024, 1024]        [1, 257, 1024]            (recursive)               --                        --
│    └─CLIPVisionEmbeddings (embeddings): 2-15                         [1, 3, 1024, 1024]        [1, 257, 1024]            (recursive)               --                        --
│    │    └─Embedding (position_embedding): 3-37                       [1, 257]                  [1, 257, 1024]            (recursive)               --                        263,168
│    └─LayerNorm (pre_layrnorm): 2-16                                  [1, 257, 1024]            [1, 257, 1024]            (recursive)               --                        2,048
│    └─NoTPTransformer (transformer): 2-17                             [1, 257, 1024]            [1, 257, 1024]            (recursive)               --                        --
│    │    └─ModuleList (layers): 3-38                                  --                        --                        (recursive)               --                        --
├─MlpProjector (projector): 1-7                                        [1, 256, 2048]            [1, 256, 1280]            (recursive)               --                        --
│    └─Linear (layers): 2-18                                           [1, 256, 2048]            [1, 256, 1280]            (recursive)               --                        2,622,720
├─ModuleList (layers): 1-8                                             --                        --                        --                        --                        --
│    └─DeepseekV2DecoderLayer (0): 2-19                                [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-39                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-40                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-41         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MLP (mlp): 3-42                                  [1, 703, 1280]            [1, 703, 1280]            26,296,320                --                        26,296,320
│    └─DeepseekV2DecoderLayer (1): 2-20                                [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-43                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-44                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-45         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MoE (mlp): 3-46                                  [1, 703, 1280]            [1, 703, 1280]            227,164,160               --                        14,577,090,560
│    └─DeepseekV2DecoderLayer (2): 2-21                                [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-47                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-48                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-49         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MoE (mlp): 3-50                                  [1, 703, 1280]            [1, 703, 1280]            227,164,160               --                        14,577,090,560
│    └─DeepseekV2DecoderLayer (3): 2-22                                [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-51                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-52                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-53         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MoE (mlp): 3-54                                  [1, 703, 1280]            [1, 703, 1280]            227,164,160               --                        14,577,090,560
│    └─DeepseekV2DecoderLayer (4): 2-23                                [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-55                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-56                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-57         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MoE (mlp): 3-58                                  [1, 703, 1280]            [1, 703, 1280]            227,164,160               --                        14,577,090,560
│    └─DeepseekV2DecoderLayer (5): 2-24                                [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-59                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-60                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-61         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MoE (mlp): 3-62                                  [1, 703, 1280]            [1, 703, 1280]            227,164,160               --                        14,577,090,560
│    └─DeepseekV2DecoderLayer (6): 2-25                                [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-63                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-64                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-65         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MoE (mlp): 3-66                                  [1, 703, 1280]            [1, 703, 1280]            227,164,160               --                        14,577,090,560
│    └─DeepseekV2DecoderLayer (7): 2-26                                [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-67                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-68                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-69         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MoE (mlp): 3-70                                  [1, 703, 1280]            [1, 703, 1280]            227,164,160               --                        14,577,090,560
│    └─DeepseekV2DecoderLayer (8): 2-27                                [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-71                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-72                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-73         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MoE (mlp): 3-74                                  [1, 703, 1280]            [1, 703, 1280]            227,164,160               --                        14,577,090,560
│    └─DeepseekV2DecoderLayer (9): 2-28                                [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-75                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-76                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-77         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MoE (mlp): 3-78                                  [1, 703, 1280]            [1, 703, 1280]            227,164,160               --                        14,577,090,560
│    └─DeepseekV2DecoderLayer (10): 2-29                               [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-79                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-80                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-81         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MoE (mlp): 3-82                                  [1, 703, 1280]            [1, 703, 1280]            227,164,160               --                        14,577,090,560
│    └─DeepseekV2DecoderLayer (11): 2-30                               [1, 703, 1280]            [1, 703, 1280]            --                        --                        --
│    │    └─DeepseekV2RMSNorm (input_layernorm): 3-83                  [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─LlamaFlashAttention2 (self_attn): 3-84                     --                        [1, 703, 1280]            6,553,600                 --                        6,553,600
│    │    └─DeepseekV2RMSNorm (post_attention_layernorm): 3-85         [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
│    │    └─DeepseekV2MoE (mlp): 3-86                                  [1, 703, 1280]            [1, 703, 1280]            227,164,160               --                        14,577,090,560
├─DeepseekV2RMSNorm (norm): 1-9                                        [1, 703, 1280]            [1, 703, 1280]            1,280                     --                        1,280
===================================================================================================================================================================================================
Total params: 3,170,627,840
Trainable params: 3,170,627,840
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 184.27
===================================================================================================================================================================================================
Input size (MB): 16.13
Forward/backward pass size (MB): 6235.73
Params size (MB): 6306.04
Estimated Total Size (MB): 12557.90
===================================================================================================================================================================================================